<html xmlns:th="http://www.thymeleaf.org"
xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
<title>ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
/* wrapper */
	#wrapper{
		justify-content: center;
		width:100%;
		display:grid;
		grid-template-columns:repeat(4, 1fr);
		grid-template-rows:repeat(1);
		grid-template-areas:
			"box2 box2 box2 box2";
		margin: 0px auto;
		padding: 0px;	
	}
	.box{
		padding:15px;
	}
	.box1{
		grid-area:box1
	}
	.box2{
		grid-area:box2
	}

    </style>

<link th:href="@{/css/main.css}" rel="stylesheet">

</head>
<body th:align="center">
	<div class="d-flex" id="wrapper">
		<div id="page-content-wrapper">
			<div th:insert="~{fragment/header :: header}"></div>
			<!-- Page content-->
			<div class="container-fluid">
				<!------------ ì—¬ê¸°ë¶€í„° ë©”ì¸ ë°”ë””! ì—¬ê¸°ë¶€í„° ì‘ì„±í•˜ë©´ ë¨ ---------------->  
				
<div id="wrapper">
					<div class="box box2"> 
						<div th:align="center">
							<form th:action="@{/board/insertBoard}" method="post">
								<br>
								<br>
								<h2 th:align="center" style="font-weight:700" th:text="${board.title}">  </h2>
								<!-- NOTICE, LOST, FOOD, TMI, QNA, MEET ifë¬¸ ì‚¬ìš©í•´ì„œ í•´ë‹¹í•˜ëŠ” ë‹¨ì–´ê°€ ë‚˜ì˜¤ë©´ ê¸€ì ë„ìš°ê¸° -->
								<br>
								
							<div style="display:flex; width:1100" class="mb-3" th:switch="${board.cmCategory.toString()}">
								<span th:case="NOTICE" th:align="left" class="border-bottom" style="flex-grow: 1;">ğŸš¨ ê³µì§€ì‚¬í•­</span>
								<span th:case="LOST" th:align="left" class="border-bottom" style="flex-grow: 1;">ğŸ˜¥ ìƒì–´ë²„ë ¸ì–´ìš”</span>
								<span th:case="FOOD" th:align="left" class="border-bottom" style="flex-grow: 1;">ğŸ” ì—¬ê¸° ë§›ë‚˜ìš”</span>
								<span th:case="TMI" th:align="left" class="border-bottom" style="flex-grow: 1;">ğŸ”‰ ì•Œë ¤ë“œë ¤ìš”</span>
								<span th:case="QNA" th:align="left" class="border-bottom" style="flex-grow: 1;">â“ &nbsp;ê¶ê¸ˆí•´ìš”</span>
								<span th:case="MEET" th:align="left" class="border-bottom" style="flex-grow: 1;">ğŸ™‹â€â™€ï¸ ìš°ë¦¬ë§Œë‚˜ìš”</span>
							
						

								<span th:align="right" class="border-bottom" style="flex-grow: 1;" th:text="${board.regdate}"></span>	
							</div>	
							<div style="display:flex; width:1100" class="mb-3">
								<span th:align="left" style="font-weight:860; font-size:1.2rem; margin-left:30px;">
								<a style="text-decoration: none; color: #333" th:href="@{/mypage/myPageMain(id=${board.userId.id})}"  th:text="${board.userId.nickName}"></a></span>
							</div>
							<div th:align="center">
									<th:block th:if="${board.photoPath} == null">
										<img src="/images/bigcarrot.png" alt="ì‚¬ì§„ ì¶œë ¥ì— ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤."  style="width:300px; margin-top:50px;">
									</th:block>
									<th:block th:if="${board.photoPath} != null">
										<img th:src="@{${board.photoPath}}" alt="ì‚¬ì§„ ì¶œë ¥ì— ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤."  style="width:500px;">
									</th:block>
								</div>
							<br><br>
							<div style="width:860px" align="left" th:align="center">
								<p th:text="${board.content}">
							</div>
							</form>	
						</div>	
						<br>
								
				  <!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
						<form id="replyForm">
						 	<input type="hidden" id="boardId" th:value="${board.postNum}" />
						   	<textarea id="replyContent" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”."></textarea>
						    <button type="submit">ëŒ“ê¸€ ì‘ì„±</button>
						</form>
						
						<!-- ëŒ“ê¸€ ëª©ë¡ -->
						<table id="replyList">
						    <tr th:Each="reply : ${replies}">
						    	<td th:text="${reply.replyContent}"></td>
						        <td><button class="deleteReply" data-id="${reply.replyNum}">ì‚­ì œ</button></td>
						    </tr>
						</table>
						
			<div th:align="center">		
			<a style="margin:5px" th:href="@{/board/insertBoard}"><button type="button" class="btn btn-outline-secondary">ìƒˆ ê²Œì‹œê¸€</button></a>
			<button type="button" class="btn btn-outline-secondary" onclick="history.back()">ê¸€ ëª©ë¡</button>
			<a sec:authorize = "hasAuthority('ROLE_ADMIN')" th:href="@{/board/deleteBoard(postNum=${board.postNum})}">ê¸€ì‚­ì œ</a>
			</div>
			<br><br><br>		
	</div>	
</div>

	<!------------ ì—¬ê¸°ê¹Œì§€ ë©”ì¸ ë°”ë””! ì—¬ê¸°ê¹Œì§€ ì‘ì„±í•˜ë©´ ë¨ ---------------->
			</div>
		</div>
	</div>
</body>
<script type="text/javascript">
let boardId = $('#boardId').val();

$(document).ready(function() {
    // ëŒ“ê¸€ ì‘ì„±
    $('#replyForm').submit(function(e) {
        e.preventDefault();

        let replyData = {
            "replyContent": $('#replyContent').val(),
            "boardId": boardId
        };

        $.ajax({
            type: "POST",
            url: "/reply/getBoard",
            data: JSON.stringify(replyData),
            contentType: "application/json",
            success: function(response) {
                // ëŒ“ê¸€ ì¶”ê°€ ì½”ë“œ (ì˜ˆ: ëŒ“ê¸€ ëª©ë¡ì— ìƒˆë¡œìš´ ëŒ“ê¸€ ì¶”ê°€)
            },
            error: function(error) {
                alert("ëŒ“ê¸€ ì‘ì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ");
            }
        });
    });

    // ëŒ“ê¸€ ì‚­ì œ
    $(document).on('click', '.deleteReply', function() {
        let replyId = $(this).data('id');

        $.ajax({
            type: "DELETE",
            url: "/reply/delete?id=" + replyId,
            success: function(response) {
                // ëŒ“ê¸€ ì‚­ì œ ì½”ë“œ (ì˜ˆ: ëŒ“ê¸€ ëª©ë¡ì—ì„œ í•´ë‹¹ ëŒ“ê¸€ ì œê±°)
            },
            error: function(error) {
                alert("ëŒ“ê¸€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ");
            }
        });
    });
});

//=======================================


</script>
</html>

